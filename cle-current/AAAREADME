Notes on the program CLE, by P. Judge.
Original: December 1, 2005
Updated:  July 13, 2006
Updated: Dec  21, 2012  (makefiles put into one file, makefile.osx)

WHAT THE CODE DOES
------------------

For details see Casini, R. & Judge, P. G., 1999. ApJ 522, 524-539.

The program CLE computes emission coefficients for Stokes I,Q,U and V
for magnetic dipole coronal emission lines.  The emission coefficients
are integrated along each line-of-sight to produce emergent
intensities (erg/cm2/s/sr/A and erg/cm2/s/sr) in these lines.  Just
one atomic ion at a time is computed (e.g., Fe XIII).  

The code assumes thermal collisional processes (but may allow proton
and electron temperatures to differ, if proton collision rates exist
in the ionic model - file ATOM).  At each grid point, it computes the
total population of all the ion's level populations from a table of
ionization equilibria from CHIANTI.  It then solves the statistical
equilibrium equations using the irreducible tensor basis for
bound-bound processes within each ion (see Casini, R. & Judge, P. G.,
1999. ApJ 522, 524-539).  The incident radiation is limb-darkened,
solar radiation from Allen (1973, A.Q.).  The emergent Stokes
parameters are computed by integrating all emission coefficients along
the line-of-sight.  The reference direction for Stokes Q is I believe
along the Y axis defined below. (NOTE- this is being checked July 13,
2006).

Because the bound-bound and bound-free processes are treated
separately, one can even make a calculation with no collisional
effects in the bound-bound calculations (set ICOLL=0 in file INPUT). 



COORDINATES
-----------

In the program the observer's geometry relative to sun
center uses Cartesian and spherical polar coordinates.

The X axis is aligned along the line of sight, and the Z and
Y axes lie in the plane of the sky (X=0) intersecting Sun
center.  The Y axis corresponds to E-W, Z axis is N-S. The
point (x,y,z)=(0,0,0) is Sun center. X increases with
distance from the observer. Y increases towards the west, Z
increases towards N.

The spherical polar coordinates (R, theta, phi) are given as
follows.  R is measured from (x,y,z)=(0,0,0).  Theta is
measured clockwise from the positive z-axis. Phi is measured
from the positive X-axis.

The magnetic field and coronal parameters must be given by a
subroutine which returns local values of the vector magnetic
field, the electron density, hydrogen (proton plus neutral)
density, temperature, plasma line of sight velocity,
microturbulent velocity, as a function of the polar position
(R,theta,phi).  As an example, the following first line of a
subroutine to compute dipolar fields is given:

	SUBROUTINE DIPOLE(RAD,THET,PH,B,T,P,EDENS,HDENS,
     *    TEMP,VEL,TURBV,IPRINT)

Thus, at spherical polar position (RAD, THET, PH) the
routine returns the magnitude of magnetic field B, and its
orientation (by polar angles T and P) and the thermal
parameters and velocities. 

